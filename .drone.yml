workspace:
  base: /go
  path: src/github.com/eidolon/console

pipeline:
  test:
    image: golang:${GO_VERSION}
    commands:
    - go get github.com/golang/lint/golint
    - go get ./...
    - golint -set_exit_status ./...
    - go vet ./...
    - go test -cover ./...

  notify:
    image: plugins/slack
    webhook: ${SLACK_WEBHOOK}
    channel: builds
    username: Drone Bot
    template: |
      *{{ uppercase build.status }}*: Build *<{{ build.link }}|#{{ build.number }}>* for *<https://github.com/{{ repo.owner }}/{{ repo.name }}/tree/{{ build.commit }}|{{ repo.owner }}/{{ repo.name }}#{{ truncate build.commit 8 }} ({{ build.branch }})>* by *{{ build.author }}*
      - GO_VERSION=${GO_VERSION}
    when:
      status: [ success, failure ]

matrix:
  GO_VERSION:
  - 1.7
  - 1.8
